# Tests
> Инструмент для тестирования сервиса movies

### Есть два способа запустить тесты
- Изолировано, в docker контейнере
- Локально, выполнив команду `pytest` с нужными параметрами


### Создать директории для хранения данных тестового приложения, если их еще нет:
Находясь в `./tests/`
```
mkdir dbs
mkdir dbs/es_data
mkdir dbs/redis-data
mkdir dbs/etl-data
```

### Описать переменные в файле `./tests/.env`

Переменные из файла буду использоваться в способе с изоолированным запуском.
Для локального запуска переменные заданы по умолчанию в файле `./tests/settings.py` их можно переопределить черезе перменные окружения
```
cp .example.env .env
```

### Запустить сервис movies
Образ перебилдится с актуальной версии кода(если был собран ранее), а с помощью depends запустится все необходимое
```
docker compose up -d movies --build
```

### Запустить тесты
- **_Изолировано_**, убедившись что  в ./tests/.env` актуальные энвы
```
docker compose up tests --build
```

- _**Локально**_, убедившись что сервис запущен и порты проброшены, в том числе порты эластика

```
pytest ./src -vv
```